<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>KARANKA MULTIVERSE ALGO AI - DERIV PRODUCTION</title>
    <script src="https://cdn.socket.io/4.5.0/socket.io.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background-color: #000000;
            color: #FFD700;
            padding: 10px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #0a0a0a;
            border: 2px solid #FFD700;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.5rem;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            border-bottom: 2px solid #FFD700;
            padding-bottom: 10px;
            color: #FFD700;
        }
        
        h2 {
            color: #D4AF37;
            font-size: 1.2rem;
            margin: 10px 0;
            border-left: 4px solid #FFD700;
            padding-left: 8px;
        }
        
        h3 {
            color: #FFED4E;
            font-size: 1rem;
            margin: 8px 0;
        }
        
        .status-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
            padding: 12px;
            background: #000000;
            border: 1px solid #FFD700;
            border-radius: 5px;
        }
        
        .status-item {
            font-size: 0.9rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .status-item span:first-child {
            color: #B8860B;
            font-size: 0.8rem;
        }
        
        .status-item span:last-child {
            font-weight: bold;
            font-size: 1.1rem;
            color: #FFD700;
        }
        
        .status-on {
            color: #00FF00 !important;
            text-shadow: 0 0 10px #00FF00;
        }
        
        .status-off {
            color: #FF4444 !important;
            text-shadow: 0 0 10px #FF4444;
        }
        
        .tab-container {
            display: flex;
            gap: 3px;
            margin-bottom: 15px;
            border-bottom: 2px solid #FFD700;
            padding-bottom: 5px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .tab-button {
            background: transparent;
            color: #FFD700;
            border: 1px solid #FFD700;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
            border-radius: 5px 5px 0 0;
            white-space: nowrap;
            flex: 0 1 auto;
        }
        
        .tab-button:hover, .tab-button.active {
            background: #FFD700;
            color: #000000;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
            padding: 15px;
            background: #000000;
            border: 1px solid #333333;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .signal-card {
            background: #0a0a0a;
            border: 1px solid #FFD700;
            border-radius: 5px;
            padding: 12px;
            margin-bottom: 10px;
        }
        
        .signal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            border-bottom: 1px solid #333333;
            padding-bottom: 5px;
        }
        
        .signal-symbol {
            font-weight: bold;
            color: #FFD700;
            font-size: 1.1rem;
        }
        
        .signal-type {
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .signal-type.buy {
            background: #00FF00;
            color: #000000;
        }
        
        .signal-type.sell {
            background: #FF4444;
            color: #FFFFFF;
        }
        
        .signal-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
            font-size: 0.85rem;
        }
        
        .signal-detail {
            display: flex;
            flex-direction: column;
        }
        
        .signal-detail .label {
            color: #B8860B;
            font-size: 0.75rem;
        }
        
        .signal-detail .value {
            color: #FFED4E;
            font-weight: bold;
        }
        
        .signal-confidence {
            height: 6px;
            background: #333333;
            border-radius: 3px;
            margin: 8px 0;
            overflow: hidden;
        }
        
        .confidence-bar {
            height: 100%;
            background: #FFD700;
            border-radius: 3px;
        }
        
        .trade-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
            gap: 5px;
            padding: 8px;
            border-bottom: 1px solid #333333;
            font-size: 0.8rem;
        }
        
        .trade-header {
            font-weight: bold;
            color: #D4AF37;
            background: #0a0a0a;
        }
        
        .trade-profit {
            color: #00FF00;
        }
        
        .trade-loss {
            color: #FF4444;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            color: #B8860B;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            background: #000000;
            border: 2px solid #FFD700;
            color: #FFD700;
            border-radius: 5px;
            font-size: 0.95rem;
        }
        
        input:focus, select:focus {
            outline: none;
            box-shadow: 0 0 10px #FFD700;
        }
        
        button {
            background: #8B7500;
            color: #FFD700;
            border: none;
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s;
            margin-right: 8px;
            margin-bottom: 8px;
            border: 1px solid #FFD700;
        }
        
        button:hover {
            background: #FFD700;
            color: #000000;
            transform: scale(1.02);
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }
        
        .start-btn {
            background: #006400;
            border-color: #00FF00;
            color: #00FF00;
        }
        
        .stop-btn {
            background: #8B0000;
            border-color: #FF4444;
            color: #FF4444;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 8px;
            max-height: 500px;
            overflow-y: auto;
            padding: 10px;
            background: #0a0a0a;
            border: 1px solid #333333;
            border-radius: 5px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #FFD700;
            font-size: 0.9rem;
            padding: 3px;
        }
        
        .checkbox-item:hover {
            background: #1a1a1a;
            border-radius: 3px;
        }
        
        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin-right: 5px;
            accent-color: #FFD700;
        }
        
        .market-category {
            grid-column: 1 / -1;
            color: #D4AF37;
            font-weight: bold;
            margin-top: 15px;
            margin-bottom: 5px;
            border-bottom: 1px solid #FFD700;
            padding-bottom: 5px;
            font-size: 1rem;
        }
        
        .market-category:first-of-type {
            margin-top: 0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .stat-card {
            background: #0a0a0a;
            border: 1px solid #FFD700;
            border-radius: 5px;
            padding: 12px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.6rem;
            font-weight: bold;
            color: #FFD700;
            line-height: 1.2;
        }
        
        .stat-label {
            color: #B8860B;
            font-size: 0.8rem;
            text-transform: uppercase;
        }
        
        .market-state-badge {
            display: inline-block;
            padding: 4px 8px;
            background: #333333;
            color: #FFD700;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            margin: 2px;
        }
        
        .log-container {
            background: #000000;
            border: 1px solid #333333;
            border-radius: 5px;
            padding: 10px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.8rem;
            color: #FFED4E;
        }
        
        .footer {
            text-align: center;
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid #333333;
            color: #B8860B;
            font-size: 0.8rem;
        }
        
        .selection-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 15px;
            padding: 10px;
            background: #0a0a0a;
            border: 1px solid #FFD700;
            border-radius: 5px;
        }
        
        .selection-btn {
            background: #8B7500;
            padding: 8px 12px;
            font-size: 0.9rem;
            margin: 0;
        }
        
        .selection-btn.select-all {
            background: #006400;
        }
        
        .selection-btn.deselect-all {
            background: #8B0000;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 8px;
            }
            
            h1 {
                font-size: 1.2rem;
            }
            
            .tab-button {
                padding: 6px 10px;
                font-size: 0.8rem;
            }
            
            .signal-details {
                grid-template-columns: 1fr 1fr;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr 1fr;
            }
            
            .selection-buttons {
                flex-direction: column;
            }
            
            .selection-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèÜ KARANKA MULTIVERSE ALGO AI - DERIV PRODUCTION</h1>
        
        <!-- Status Panel -->
        <div class="status-panel">
            <div class="status-item">
                <span>CONNECTION</span>
                <span id="connection-status" class="status-off">DISCONNECTED</span>
            </div>
            <div class="status-item">
                <span>TRADING</span>
                <span id="trading-status" class="status-off">STOPPED</span>
            </div>
            <div class="status-item">
                <span>MODE</span>
                <span id="mode-status">DRY RUN</span>
            </div>
            <div class="status-item">
                <span>ACTIVE</span>
                <span id="active-count">0</span>
            </div>
            <div class="status-item">
                <span>DAILY P&L</span>
                <span id="daily-pnl">$0.00</span>
            </div>
            <div class="status-item">
                <span>WIN RATE</span>
                <span id="win-rate">0%</span>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div class="tab-container">
            <button class="tab-button active" onclick="showTab('dashboard')">üìä DASHBOARD</button>
            <button class="tab-button" onclick="showTab('analysis')">üìà ANALYSIS</button>
            <button class="tab-button" onclick="showTab('markets')">üìä MARKETS</button>
            <button class="tab-button" onclick="showTab('settings')">‚öôÔ∏è SETTINGS</button>
            <button class="tab-button" onclick="showTab('connection')">üîó CONNECTION</button>
            <button class="tab-button" onclick="showTab('monitor')">üëÅÔ∏è MONITOR</button>
        </div>
        
        <!-- Dashboard Tab -->
        <div id="dashboard-tab" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="stat-active">0</div>
                    <div class="stat-label">ACTIVE TRADES</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-daily">0</div>
                    <div class="stat-label">DAILY TRADES</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-pnl">$0</div>
                    <div class="stat-label">DAILY P&L</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-winrate">0%</div>
                    <div class="stat-label">WIN RATE</div>
                </div>
            </div>
            
            <h2>üîç ACTIVE SIGNALS</h2>
            <div id="active-signals">
                <div class="signal-card">
                    <div style="text-align: center; color: #B8860B; padding: 20px;">
                        Waiting for market analysis...
                    </div>
                </div>
            </div>
            
            <h2>üìà MARKET STATES</h2>
            <div id="market-states" style="margin-bottom: 15px;">
                <!-- Filled by JS -->
            </div>
            
            <div class="button-group">
                <button class="start-btn" onclick="startTrading()">üöÄ START TRADING</button>
                <button class="stop-btn" onclick="stopTrading()">üõë STOP TRADING</button>
                <button onclick="refreshData()">üîÑ REFRESH</button>
            </div>
        </div>
        
        <!-- Analysis Tab -->
        <div id="analysis-tab" class="tab-content">
            <h2>üìä LIVE MARKET ANALYSIS</h2>
            <div id="analysis-details">
                <!-- Filled by JS -->
            </div>
            
            <h2>üìú STRATEGY INFO</h2>
            <div style="background: #0a0a0a; border: 1px solid #333333; border-radius: 5px; padding: 15px;">
                <p><span style="color: #D4AF37;">‚úÖ MARKET STATE ENGINE:</span> <span style="color: #FFED4E;">ACTIVE</span></p>
                <p><span style="color: #D4AF37;">‚úÖ CONTINUATION (SWAPPED):</span> <span style="color: #FFED4E;">SELL in uptrend, BUY in downtrend</span></p>
                <p><span style="color: #D4AF37;">‚úÖ QUASIMODO (SWAPPED):</span> <span style="color: #FFED4E;">BUY from bearish, SELL from bullish</span></p>
                <p><span style="color: #D4AF37;">‚úÖ 2 PIP RETEST:</span> <span style="color: #FFED4E;">ACTIVE</span></p>
                <p><span style="color: #D4AF37;">‚úÖ HTF STRUCTURE:</span> <span style="color: #FFED4E;">MANDATORY</span></p>
                <p><span style="color: #D4AF37;">‚úÖ MIN CONFIDENCE:</span> <span style="color: #FFED4E;">65%</span></p>
                <p><span style="color: #D4AF37;">‚úÖ FRESH PATTERNS:</span> <span style="color: #FFED4E;">MAX 8 CANDLES</span></p>
                <p><span style="color: #D4AF37;">‚úÖ TOTAL MARKETS:</span> <span style="color: #FFED4E;">30+ CFD & SYNTHETICS</span></p>
            </div>
        </div>
        
        <!-- Markets Tab -->
        <div id="markets-tab" class="tab-content">
            <h2>üìä SELECT MARKETS (30+ CFD & SYNTHETICS)</h2>
            
            <div class="selection-buttons">
                <button class="selection-btn" onclick="selectAllSynthetics()">üé≤ Select All Synthetics</button>
                <button class="selection-btn" onclick="selectAllForex()">üí± Select All Forex</button>
                <button class="selection-btn" onclick="selectAllIndices()">üìä Select All Indices</button>
                <button class="selection-btn" onclick="selectAllCommodities()">ü™ô Select All Commodities</button>
                <button class="selection-btn" onclick="selectAllCrypto()">‚Çø Select All Crypto</button>
                <button class="selection-btn select-all" onclick="selectAllSymbols()">‚úÖ SELECT ALL</button>
                <button class="selection-btn deselect-all" onclick="deselectAllSymbols()">‚ùå DESELECT ALL</button>
            </div>
            
            <div class="checkbox-group" id="markets-list">
                <!-- ============ SYNTHETICS ============ -->
                <div class="market-category">üé≤ VOLATILITY INDICES (10)</div>
                
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="R_10" checked>
                    <span>R_10 - Volatility 10</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="R_25" checked>
                    <span>R_25 - Volatility 25</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="R_50" checked>
                    <span>R_50 - Volatility 50</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="R_75" checked>
                    <span>R_75 - Volatility 75</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="R_100" checked>
                    <span>R_100 - Volatility 100</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="R_150" checked>
                    <span>R_150 - Volatility 150</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="R_200" checked>
                    <span>R_200 - Volatility 200</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="R_250" checked>
                    <span>R_250 - Volatility 250</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="VR10" checked>
                    <span>VR10 - Volatility 10 (1s)</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="VR100" checked>
                    <span>VR100 - Volatility 100 (1s)</span>
                </div>
                
                <!-- ============ JUMP INDICES ============ -->
                <div class="market-category">ü¶ò JUMP INDICES (4)</div>
                
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="J_10" checked>
                    <span>J_10 - Jump 10</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="J_25" checked>
                    <span>J_25 - Jump 25</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="J_50" checked>
                    <span>J_50 - Jump 50</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="J_100" checked>
                    <span>J_100 - Jump 100</span>
                </div>
                
                <!-- ============ CRASH/BOOM ============ -->
                <div class="market-category">üí• CRASH & BOOM (4)</div>
                
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="BOOM300" checked>
                    <span>BOOM300 - Boom 300</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="BOOM500" checked>
                    <span>BOOM500 - Boom 500</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="CRASH300" checked>
                    <span>CRASH300 - Crash 300</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="CRASH500" checked>
                    <span>CRASH500 - Crash 500</span>
                </div>
                
                <!-- ============ STEP INDICES ============ -->
                <div class="market-category">ü™ú STEP INDICES (3)</div>
                
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="STP10" checked>
                    <span>STP10 - Step 10</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="STP50" checked>
                    <span>STP50 - Step 50</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox synth" value="STP100" checked>
                    <span>STP100 - Step 100</span>
                </div>
                
                <!-- ============ FOREX MAJORS ============ -->
                <div class="market-category">üí± FOREX MAJORS (7)</div>
                
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="EURUSD" checked>
                    <span>EURUSD - Euro/US Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="GBPUSD" checked>
                    <span>GBPUSD - British Pound/US Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="USDJPY" checked>
                    <span>USDJPY - US Dollar/Japanese Yen</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="AUDUSD" checked>
                    <span>AUDUSD - Australian Dollar/US Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="USDCAD" checked>
                    <span>USDCAD - US Dollar/Canadian Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="USDCHF" checked>
                    <span>USDCHF - US Dollar/Swiss Franc</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="NZDUSD" checked>
                    <span>NZDUSD - New Zealand Dollar/US Dollar</span>
                </div>
                
                <!-- ============ FOREX MINORS ============ -->
                <div class="market-category">üí± FOREX MINORS & CROSSES (8)</div>
                
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="EURGBP" checked>
                    <span>EURGBP - Euro/British Pound</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="EURJPY" checked>
                    <span>EURJPY - Euro/Japanese Yen</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="GBPJPY" checked>
                    <span>GBPJPY - British Pound/Japanese Yen</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="AUDJPY" checked>
                    <span>AUDJPY - Australian Dollar/Japanese Yen</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="EURAUD" checked>
                    <span>EURAUD - Euro/Australian Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="GBPAUD" checked>
                    <span>GBPAUD - British Pound/Australian Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="CADJPY" checked>
                    <span>CADJPY - Canadian Dollar/Japanese Yen</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox forex" value="CHFJPY" checked>
                    <span>CHFJPY - Swiss Franc/Japanese Yen</span>
                </div>
                
                <!-- ============ INDICES ============ -->
                <div class="market-category">üìä STOCK INDICES (5)</div>
                
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox index" value="US30" checked>
                    <span>US30 - US Wall Street 30</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox index" value="US100" checked>
                    <span>US100 - US Nasdaq 100</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox index" value="US500" checked>
                    <span>US500 - US S&P 500</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox index" value="UK100" checked>
                    <span>UK100 - UK FTSE 100</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox index" value="GER40" checked>
                    <span>GER40 - Germany DAX 40</span>
                </div>
                
                <!-- ============ COMMODITIES ============ -->
                <div class="market-category">ü™ô COMMODITIES (4)</div>
                
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox commodity" value="XAUUSD" checked>
                    <span>XAUUSD - Gold vs US Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox commodity" value="XAGUSD" checked>
                    <span>XAGUSD - Silver vs US Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox commodity" value="XPTUSD" checked>
                    <span>XPTUSD - Platinum vs US Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox commodity" value="XPDUSD" checked>
                    <span>XPDUSD - Palladium vs US Dollar</span>
                </div>
                
                <!-- ============ CRYPTO ============ -->
                <div class="market-category">‚Çø CRYPTOCURRENCY (4)</div>
                
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox crypto" value="BTCUSD" checked>
                    <span>BTCUSD - Bitcoin vs US Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox crypto" value="ETHUSD" checked>
                    <span>ETHUSD - Ethereum vs US Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox crypto" value="LTCUSD" checked>
                    <span>LTCUSD - Litecoin vs US Dollar</span>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" class="symbol-checkbox crypto" value="BCHUSD" checked>
                    <span>BCHUSD - Bitcoin Cash vs US Dollar</span>
                </div>
            </div>
            
            <div style="margin-top: 15px; padding: 10px; background: #0a0a0a; border: 1px solid #FFD700; border-radius: 5px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: #FFD700;">Selected: <span id="selected-count">30</span> markets</span>
                    <button onclick="saveSymbols()" style="background: #006400; padding: 10px 20px;">üíæ SAVE SELECTION</button>
                </div>
            </div>
        </div>
        
        <!-- Settings Tab -->
        <div id="settings-tab" class="tab-content">
            <h2>‚öôÔ∏è TRADING SETTINGS</h2>
            
            <div class="form-group">
                <label>Mode:</label>
                <select id="setting-mode">
                    <option value="true">üü° DRY RUN (Simulated)</option>
                    <option value="false">üî¥ LIVE (Real Money)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Fixed Trade Amount ($):</label>
                <input type="number" id="setting-amount" value="1.0" min="0.35" step="0.01">
            </div>
            
            <div class="form-group">
                <label>Max Daily Trades:</label>
                <input type="number" id="setting-daily" value="20" min="1" max="50">
            </div>
            
            <div class="form-group">
                <label>Max Concurrent Trades:</label>
                <input type="number" id="setting-concurrent" value="3" min="1" max="5">
            </div>
            
            <div class="form-group">
                <label>Min Seconds Between Trades:</label>
                <input type="number" id="setting-seconds" value="10" min="5" max="60">
            </div>
            
            <div class="form-group">
                <label>Minimum Confidence %:</label>
                <input type="number" id="setting-confidence" value="65" min="50" max="95">
            </div>
            
            <button onclick="saveSettings()">üíæ SAVE SETTINGS</button>
        </div>
        
        <!-- Connection Tab -->
        <div id="connection-tab" class="tab-content">
            <h2>üîó DERIV CONNECTION</h2>
            
            <div class="form-group">
                <label>API Token:</label>
                <input type="password" id="api-token" placeholder="Enter your Deriv API token">
            </div>
            
            <div class="button-group">
                <button onclick="connectDeriv()">üîó CONNECT</button>
                <button onclick="disconnectDeriv()">üîå DISCONNECT</button>
            </div>
            
            <div id="connection-log" class="log-container">
                <div>‚ö° Ready to connect to Deriv...</div>
            </div>
        </div>
        
        <!-- Monitor Tab -->
        <div id="monitor-tab" class="tab-content">
            <h2>üìä ACTIVE TRADES</h2>
            <div id="active-trades-list">
                <!-- Filled by JS -->
            </div>
            
            <h2>üìú TRADE HISTORY</h2>
            <div id="trade-history-list">
                <!-- Filled by JS -->
            </div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            ¬© 2025 KARANKA MULTIVERSE ALGO AI | MARKET STATE ENGINE | SMART SELECTOR | 2 PIP RETEST | 30+ MARKETS
        </div>
    </div>
    
    <script>
        // Socket.IO connection
        const socket = io();
        
        // Global variables
        let connected = false;
        let trading = false;
        let enabledSymbols = [];
        
        // Socket events
        socket.on('connect', function() {
            console.log('Connected to server');
            socket.emit('request_update');
        });
        
        socket.on('market_update', function(data) {
            updateMarketAnalysis(data);
        });
        
        socket.on('trade_update', function(data) {
            updateTradeData(data);
        });
        
        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabName + '-tab').classList.add('active');
        }
        
        // Connection functions
        function connectDeriv() {
            const token = document.getElementById('api-token').value;
            if (!token) {
                alert('Please enter API token');
                return;
            }
            
            addLog('üîå Connecting to Deriv...');
            
            fetch('/api/connect', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({token: token})
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    connected = true;
                    document.getElementById('connection-status').innerHTML = 'CONNECTED';
                    document.getElementById('connection-status').className = 'status-on';
                    addLog('‚úÖ ' + data.message);
                } else {
                    addLog('‚ùå ' + data.message);
                }
            })
            .catch(err => {
                addLog('‚ùå Connection error: ' + err);
            });
        }
        
        function disconnectDeriv() {
            fetch('/api/disconnect', {method: 'POST'})
            .then(res => res.json())
            .then(data => {
                connected = false;
                trading = false;
                document.getElementById('connection-status').innerHTML = 'DISCONNECTED';
                document.getElementById('connection-status').className = 'status-off';
                document.getElementById('trading-status').innerHTML = 'STOPPED';
                document.getElementById('trading-status').className = 'status-off';
                addLog('üîå Disconnected');
            });
        }
        
        function addLog(message) {
            const log = document.getElementById('connection-log');
            const time = new Date().toLocaleTimeString();
            log.innerHTML = `<div>[${time}] ${message}</div>` + log.innerHTML;
            if (log.children.length > 10) {
                log.removeChild(log.lastChild);
            }
        }
        
        // Trading functions
        function startTrading() {
            if (!connected) {
                alert('Connect to Deriv first!');
                return;
            }
            
            // Get selected symbols
            enabledSymbols = [];
            document.querySelectorAll('.symbol-checkbox:checked').forEach(cb => {
                enabledSymbols.push(cb.value);
            });
            
            if (enabledSymbols.length === 0) {
                alert('Please select at least one market in the Markets tab');
                return;
            }
            
            const settings = {
                dry_run: document.getElementById('setting-mode').value === 'true',
                fixed_amount: parseFloat(document.getElementById('setting-amount').value),
                max_daily_trades: parseInt(document.getElementById('setting-daily').value),
                max_concurrent_trades: parseInt(document.getElementById('setting-concurrent').value),
                min_confidence: parseInt(document.getElementById('setting-confidence').value),
                enabled_symbols: enabledSymbols
            };
            
            fetch('/api/start', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(settings)
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    trading = true;
                    document.getElementById('trading-status').innerHTML = 'ACTIVE';
                    document.getElementById('trading-status').className = 'status-on';
                    document.getElementById('mode-status').innerHTML = settings.dry_run ? 'DRY RUN' : 'LIVE';
                    addLog('üöÄ ' + data.message);
                } else {
                    alert('Failed to start: ' + data.message);
                }
            });
        }
        
        function stopTrading() {
            fetch('/api/stop', {method: 'POST'})
            .then(res => res.json())
            .then(data => {
                trading = false;
                document.getElementById('trading-status').innerHTML = 'STOPPED';
                document.getElementById('trading-status').className = 'status-off';
                addLog('üõë Trading stopped');
            });
        }
        
        function refreshData() {
            socket.emit('request_update');
        }
        
        // Market selection functions
        function updateSelectedCount() {
            const count = document.querySelectorAll('.symbol-checkbox:checked').length;
            document.getElementById('selected-count').innerHTML = count;
        }
        
        function selectAllSynthetics() {
            document.querySelectorAll('.symbol-checkbox.synth').forEach(cb => {
                cb.checked = true;
            });
            updateSelectedCount();
        }
        
        function selectAllForex() {
            document.querySelectorAll('.symbol-checkbox.forex').forEach(cb => {
                cb.checked = true;
            });
            updateSelectedCount();
        }
        
        function selectAllIndices() {
            document.querySelectorAll('.symbol-checkbox.index').forEach(cb => {
                cb.checked = true;
            });
            updateSelectedCount();
        }
        
        function selectAllCommodities() {
            document.querySelectorAll('.symbol-checkbox.commodity').forEach(cb => {
                cb.checked = true;
            });
            updateSelectedCount();
        }
        
        function selectAllCrypto() {
            document.querySelectorAll('.symbol-checkbox.crypto').forEach(cb => {
                cb.checked = true;
            });
            updateSelectedCount();
        }
        
        function selectAllSymbols() {
            document.querySelectorAll('.symbol-checkbox').forEach(cb => {
                cb.checked = true;
            });
            updateSelectedCount();
        }
        
        function deselectAllSymbols() {
            document.querySelectorAll('.symbol-checkbox').forEach(cb => {
                cb.checked = false;
            });
            updateSelectedCount();
        }
        
        function saveSymbols() {
            enabledSymbols = [];
            document.querySelectorAll('.symbol-checkbox:checked').forEach(cb => {
                enabledSymbols.push(cb.value);
            });
            
            fetch('/api/settings', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({enabled_symbols: enabledSymbols})
            });
            
            alert(`‚úÖ ${enabledSymbols.length} markets selected and saved`);
        }
        
        // Settings
        function saveSettings() {
            const settings = {
                dry_run: document.getElementById('setting-mode').value === 'true',
                fixed_amount: parseFloat(document.getElementById('setting-amount').value),
                max_daily_trades: parseInt(document.getElementById('setting-daily').value),
                max_concurrent_trades: parseInt(document.getElementById('setting-concurrent').value),
                min_seconds_between: parseInt(document.getElementById('setting-seconds').value),
                min_confidence: parseInt(document.getElementById('setting-confidence').value)
            };
            
            fetch('/api/settings', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(settings)
            })
            .then(res => res.json())
            .then(data => {
                alert('‚úÖ Settings saved');
            });
        }
        
        // Update functions
        function updateMarketAnalysis(data) {
            const analysis = data.market_analysis || {};
            const signalsContainer = document.getElementById('active-signals');
            const statesContainer = document.getElementById('market-states');
            const analysisDetails = document.getElementById('analysis-details');
            
            // Count market states
            const stateCount = {};
            let signals = [];
            
            for (const [symbol, info] of Object.entries(analysis)) {
                if (info.signals && info.signals.length > 0) {
                    signals.push({symbol, ...info});
                }
                if (info.market_state) {
                    stateCount[info.market_state] = (stateCount[info.market_state] || 0) + 1;
                }
            }
            
            // Update active signals
            if (signals.length > 0) {
                let signalsHtml = '';
                signals.forEach(s => {
                    s.signals.forEach(signal => {
                        signalsHtml += `
                            <div class="signal-card">
                                <div class="signal-header">
                                    <span class="signal-symbol">${s.symbol}</span>
                                    <span class="signal-type ${signal.type.toLowerCase()}">${signal.type}</span>
                                </div>
                                <div class="signal-details">
                                    <div class="signal-detail">
                                        <span class="label">Strategy</span>
                                        <span class="value">${signal.strategy}</span>
                                    </div>
                                    <div class="signal-detail">
                                        <span class="label">Pattern</span>
                                        <span class="value">${signal.pattern}</span>
                                    </div>
                                    <div class="signal-detail">
                                        <span class="label">Entry</span>
                                        <span class="value">${signal.entry ? signal.entry.toFixed(5) : 'N/A'}</span>
                                    </div>
                                    <div class="signal-detail">
                                        <span class="label">SL/TP</span>
                                        <span class="value">${signal.sl ? signal.sl.toFixed(5) : 'N/A'} / ${signal.tp ? signal.tp.toFixed(5) : 'N/A'}</span>
                                    </div>
                                </div>
                                <div class="signal-confidence">
                                    <div class="confidence-bar" style="width: ${signal.confidence}%"></div>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 0.8rem;">
                                    <span style="color: #B8860B;">Market: ${s.market_state}</span>
                                    <span style="color: ${signal.confidence >= 80 ? '#00FF00' : '#FFD700'};">Conf: ${signal.confidence}%</span>
                                </div>
                            </div>
                        `;
                    });
                });
                signalsContainer.innerHTML = signalsHtml;
            } else {
                signalsContainer.innerHTML = `
                    <div class="signal-card">
                        <div style="text-align: center; color: #B8860B; padding: 20px;">
                            ‚è≥ Scanning ${enabledSymbols.length} markets for setups...
                        </div>
                    </div>
                `;
            }
            
            // Update market states
            let statesHtml = '<div style="display: flex; flex-wrap: wrap; gap: 8px;">';
            for (const [state, count] of Object.entries(stateCount)) {
                statesHtml += `<span class="market-state-badge">${state}: ${count}</span>`;
            }
            statesHtml += '</div>';
            if (statesContainer) statesContainer.innerHTML = statesHtml;
            
            // Update analysis details
            if (analysisDetails) {
                let detailsHtml = '';
                for (const [symbol, info] of Object.entries(analysis).slice(0, 15)) {
                    detailsHtml += `
                        <div class="signal-card">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #FFD700; font-weight: bold;">${symbol}</span>
                                <span style="color: #B8860B;">${info.market_state || 'SCANNING'}</span>
                            </div>
                            <div style="font-size: 0.9rem; margin-top: 5px;">
                                <div>Price: ${info.price ? info.price.toFixed(5) : 'N/A'}</div>
                                <div>Structure: ${info.structure || 'N/A'}</div>
                                <div>Strength: ${info.strength ? info.strength.toFixed(1) : '0'}</div>
                            </div>
                        </div>
                    `;
                }
                analysisDetails.innerHTML = detailsHtml;
            }
        }
        
        function updateTradeData(data) {
            document.getElementById('active-count').innerHTML = data.active_trades?.length || 0;
            document.getElementById('stat-active').innerHTML = data.active_trades?.length || 0;
            document.getElementById('stat-daily').innerHTML = data.daily_trades || 0;
            
            const pnl = data.daily_pnl || 0;
            document.getElementById('daily-pnl').innerHTML = `$${pnl.toFixed(2)}`;
            document.getElementById('stat-pnl').innerHTML = `$${pnl.toFixed(2)}`;
            
            document.getElementById('win-rate').innerHTML = (data.win_rate || 0) + '%';
            document.getElementById('stat-winrate').innerHTML = (data.win_rate || 0) + '%';
            
            // Update active trades list
            const activeList = document.getElementById('active-trades-list');
            if (activeList) {
                if (data.active_trades?.length > 0) {
                    let html = '';
                    data.active_trades.forEach(t => {
                        html += `
                            <div class="signal-card">
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: #FFD700;">${t.symbol}</span>
                                    <span class="signal-type ${t.direction ? t.direction.toLowerCase() : 'buy'}">${t.direction || 'BUY'}</span>
                                </div>
                                <div style="font-size: 0.85rem; margin-top: 5px;">
                                    <div>Entry: ${t.entry ? t.entry.toFixed(5) : 'N/A'}</div>
                                    <div>Amount: $${t.amount || 0}</div>
                                    <div>Confidence: ${t.confidence || 70}%</div>
                                </div>
                            </div>
                        `;
                    });
                    activeList.innerHTML = html;
                } else {
                    activeList.innerHTML = '<div style="color: #B8860B; text-align: center; padding: 20px;">No active trades</div>';
                }
            }
            
            // Update trade history
            const historyList = document.getElementById('trade-history-list');
            if (historyList) {
                const history = data.trade_history || [];
                if (history.length > 0) {
                    let html = '';
                    history.slice(-10).reverse().forEach(t => {
                        html += `
                            <div class="signal-card">
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: #FFD700;">${t.symbol}</span>
                                    <span class="${t.result === 'WIN' ? 'trade-profit' : 'trade-loss'}">${t.result || 'UNKNOWN'}</span>
                                </div>
                                <div style="font-size: 0.85rem;">
                                    <div>Profit: $${t.profit ? t.profit.toFixed(2) : '0.00'}</div>
                                    <div>Strategy: ${t.strategy || 'QUASIMODO'}</div>
                                </div>
                            </div>
                        `;
                    });
                    historyList.innerHTML = html;
                } else {
                    historyList.innerHTML = '<div style="color: #B8860B; text-align: center; padding: 20px;">No trade history</div>';
                }
            }
        }
        
        // Auto-refresh
        setInterval(() => {
            if (connected) {
                socket.emit('request_update');
            }
        }, 5000);
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set default settings
            document.getElementById('setting-mode').value = 'true';
            document.getElementById('setting-amount').value = '1.0';
            document.getElementById('setting-daily').value = '20';
            document.getElementById('setting-concurrent').value = '3';
            document.getElementById('setting-seconds').value = '10';
            document.getElementById('setting-confidence').value = '65';
            
            // Update selected count
            updateSelectedCount();
            
            // Add change listeners to checkboxes
            document.querySelectorAll('.symbol-checkbox').forEach(cb => {
                cb.addEventListener('change', updateSelectedCount);
            });
        });
    </script>
</body>
</html>
